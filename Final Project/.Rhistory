grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(State , y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","gold","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","gold","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","gold","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red3","white","white","white","white","white","white","white","white","white", "white","white","gold","white","white","white","white","white","white","gold","white","white","white","white","red3","white","gold","white","white","white","white","white","white","red3","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","orange","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","#4dfed1","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","#0bdbb6","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","gold","white","white","white","white","red","white","gold","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
#fig 8
ggplot(moderate6, aes(reorder(State,-Bad.Days) , y=Bad.Days, fill = Death.Rate)) +
geom_col()
grid.arrange(graph_PM2.5, graph_SO2, graph_CO,graph_OZONE,graph_PM10, graph_NO2, ncol=2, top="Effects of Different types of Gases on Birth Weight\nIn USA in 2007-2019", left="Death Rate", bottom= "Shadow surrounding the line represent a 95% confidence interval")
# fig 5
death_data = death_data %>% rename(Year = "Year.of.Death")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
geom_smooth()+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point()+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'purple')+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'purple'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")
AQI_data = AQI_data %>% filter(State != "Country Of Mexico", State != "Puerto Rico", State != "Virgin Islands")
AQI_data$Bad.Days = AQI_data$Moderate.Days + AQI_data$Unhealthy.for.Sensitive.Groups.Days + AQI_data$Unhealthy.Days + AQI_data$Very.Unhealthy.Days + AQI_data$Hazardous.Days
AQI_data_grouped = AQI_data %>% group_by(Year) %>% summarise_at(vars("Bad.Days"), mean)
grouped_birth_State = birth_data %>% group_by(State) %>% summarise_at(vars(Standard.Deviation.for.Average.Birth.Weight), mean)
AQI_BIRTH_merge = merge(AQI_data_grouped, grouped_birth_Year, by="Year")
ggplot(AQI_BIRTH_merge, aes(x= Bad.Days, y= Standard.Deviation.for.Average.Birth.Weight))+
geom_smooth()+
geom_jitter()
grouped_AQI_year = AQI_data %>% group_by(Year, State) %>% summarise_at(vars(Bad.Days),mean)
group_death = death_data %>% group_by(Year, State) %>% summarise_at(vars(Death.Rate), sum)
mearge_aqi_death = merge(group_death, grouped_AQI_year, by = c("Year", "State"))
#mearge_aqi_death = mearge_aqi_death %>% filter(State == "Washington")
mearge_aqi_death$Death.Rate = with(mearge_aqi_death,(Death.Rate- min(Death.Rate))/(max(Death.Rate)- min(Death.Rate)))
ggplot(mearge_aqi_death, aes(reorder(x= Year, -Bad.Days),y= Bad.Days, fill= Death.Rate))+
geom_col()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))
AQI_data_pm2.5 = AQI_data %>% group_by(State) %>% summarise_at(vars(Days.PM2.5), mean)
AQI_data_pm2.5 = AQI_data_pm2.5[order(AQI_data_pm2.5$Days.PM2.5),]
AQI_data_pm2.5
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'purple'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(rows= vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(cols= vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(cols= vars(df_to_plot$Year %>% filter(Year == 2018)))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(cols= vars(c(df_to_plot$Year %>% filter(Year == 2018)))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(cols= vars(c(df_to_plot$Year %>% filter(Year == 2018))))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_grid(cols= vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_wrap(cols= vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_wrap(vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_wrap(vars(Year),scales = "free")
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)+
facet_wrap(vars(Year))
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)
# fig 5
#death_data = death_data %>% rename(Year = "Year.of.Death")
grouped_death_year = death_data %>% group_by(Year) %>% summarise_at(vars('Death.Rate'),sum)
grouped_birth_Year = birth_data %>% group_by(Year) %>% summarise_at(vars('Standard.Deviation.for.Average.Birth.Weight'),mean)
df_to_plot = merge(grouped_death_year, grouped_birth_Year, by="Year")
ggplot(df_to_plot, aes(x= Standard.Deviation.for.Average.Birth.Weight , y= Death.Rate))+
theme_bw()+
geom_smooth()+
geom_point(aes(color = 'orange'))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2007-2019", subtitle = "state and mother's age",x= "SD for Average Birth Weight", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="SD for Average Birth Weight by Mortality Rate in USA 2007-2019", subtitle = "state and mother's age",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Income Color scala",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Income Color scala",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = Average Income)+
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Income Color scala",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Income Color scala",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)+
+ scale_fill_brewer(palette = "BrBG")
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)+
scale_fill_brewer(palette = "BrBG")
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)+
scale_fill_manual(palette = "BrBG")
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)+
scale_fill_manual(values=wes_palette(n=51, name="BrBG"))
# fig 7
grouped_death_state = death_data %>% group_by(State) %>% summarise_at(vars('Death.Rate'),sum)
grouped_income_state = income %>% group_by(State) %>% summarise_at(vars('average'),mean)
df_to_plot2 = merge(grouped_death_state, grouped_income_state, by="State")
ggplot(df_to_plot2, aes(reorder(State, -Death.Rate), y= Death.Rate, fill = average, color= State))+
geom_col()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90, vjust = 0.2, hjust=1, size= 7),
axis.text.y = element_text(size= 8),
axis.title.x = element_text(margin = unit(c(3, 0, 0, 0), "mm")),
panel.border=element_rect(fill=NA))+
labs(title="Mortality Rate in USA 2007-2019", subtitle = "Color scala - GDP per capita",x= "State", y = "Mortality Rate", caption= "Infant Mortality Rate: deaths per 1000 births\nSource: CDC WONDER - Linked Birth / Infant Death Records, 2007-2019", fill = "Average Income in USD")+
scale_color_manual(values = c("red","white","white","white","white","white","white","white","white","white", "white","white","green","white","white","white","white","white","white","green","white","white","white","white","red","white","green","white","white","white","white","white","white","red","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white","white"))+
guides(color = FALSE)
#scale_fill_ma(palette = "BrBG")
